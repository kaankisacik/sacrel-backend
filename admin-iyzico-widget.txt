// Bu script'i browser console'da Ã§alÄ±ÅŸtÄ±rÄ±n (F12 > Console)
// Order detail sayfasÄ±nda Ä°yzico Payment ID'sini gÃ¶sterir

(function() {
  // URL'den order ID'yi al
  const orderId = window.location.pathname.split('/').pop();
  
  if (!orderId || !orderId.startsWith('order_')) {
    console.log('âŒ Bu sayfa bir order detail sayfasÄ± deÄŸil');
    return;
  }
  
  console.log(`ğŸ” Order ID: ${orderId}`);
  
  // Ä°yzico bilgilerini getir
  fetch(`/admin/iyzico/order-info/${orderId}`)
    .then(response => response.json())
    .then(data => {
      console.log('ğŸ“¥ Ä°yzico API Response:', data);
      
      // Mevcut widget'Ä± kaldÄ±r (varsa)
      const existingWidget = document.getElementById('iyzico-widget');
      if (existingWidget) {
        existingWidget.remove();
      }
      
      // Widget oluÅŸtur
      const widget = document.createElement('div');
      widget.id = 'iyzico-widget';
      widget.style.cssText = `
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        margin: 16px 0;
        background-color: #fff;
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
      `;
      
      if (data.found && data.iyzico_payment_id) {
        widget.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h2 style="margin: 0; font-size: 18px; font-weight: 600;">Ä°yzico Payment</h2>
            <span style="
              background-color: #10b981;
              color: white;
              padding: 4px 8px;
              border-radius: 4px;
              font-size: 12px;
              font-weight: 500;
            ">Ä°yzico</span>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <span style="color: #6b7280; font-size: 14px;">Payment ID:</span>
            <span style="
              font-family: monospace;
              font-size: 14px;
              font-weight: 500;
              background-color: #f3f4f6;
              padding: 4px 8px;
              border-radius: 4px;
              border: 1px solid #d1d5db;
            ">"${data.iyzico_payment_id}"</span>
          </div>
        `;
        
        console.log(`âœ… Ä°yzico Payment ID: "${data.iyzico_payment_id}"`);
      } else {
        widget.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h2 style="margin: 0; font-size: 18px; font-weight: 600;">Ä°yzico Payment</h2>
            <span style="
              background-color: #f59e0b;
              color: white;
              padding: 4px 8px;
              border-radius: 4px;
              font-size: 12px;
              font-weight: 500;
            ">Not Ä°yzico</span>
          </div>
          <p style="margin: 0; color: #6b7280; font-size: 14px;">
            Bu sipariÅŸ Ä°yzico ile Ã¶denmemiÅŸ.
          </p>
        `;
        
        console.log('âŒ Bu sipariÅŸ Ä°yzico ile Ã¶denmemiÅŸ');
      }
      
      // Widget'Ä± sayfaya ekle (Order Details'Ä±n sonuna)
      const orderDetailsSection = document.querySelector('[data-testid="order-summary"]') || 
                                  document.querySelector('.order-summary') ||
                                  document.querySelector('main') ||
                                  document.body;
      
      if (orderDetailsSection) {
        orderDetailsSection.appendChild(widget);
        console.log('âœ… Ä°yzico widget sayfaya eklendi');
      } else {
        console.log('âš ï¸ Order details section bulunamadÄ±, widget body\'ye ekleniyor');
        document.body.appendChild(widget);
      }
    })
    .catch(error => {
      console.error('âŒ Ä°yzico API hatasÄ±:', error);
      
      // Hata widget'Ä±
      const widget = document.createElement('div');
      widget.id = 'iyzico-widget';
      widget.style.cssText = `
        border: 1px solid #fca5a5;
        border-radius: 8px;
        padding: 16px;
        margin: 16px 0;
        background-color: #fef2f2;
      `;
      widget.innerHTML = `
        <h2 style="margin: 0 0 8px 0; font-size: 18px; font-weight: 600; color: #dc2626;">
          Ä°yzico Payment - Hata
        </h2>
        <p style="margin: 0; color: #7f1d1d; font-size: 14px;">
          Ä°yzico bilgileri alÄ±namadÄ±: ${error.message}
        </p>
      `;
      
      document.body.appendChild(widget);
    });
})();

// Otomatik Ã§alÄ±ÅŸtÄ±rma iÃ§in bookmark oluÅŸturun:
console.log(`
ğŸ“‹ BOOKMARK OLUÅTURUN:
1. Bu kodu kopyalayÄ±n (javascript: ile baÅŸlayan kÄ±sÄ±m):

javascript:(function(){const orderId=window.location.pathname.split('/').pop();if(!orderId||!orderId.startsWith('order_')){alert('Bu sayfa bir order detail sayfasÄ± deÄŸil');return;}fetch('/admin/iyzico/order-info/'+orderId).then(r=>r.json()).then(data=>{const existing=document.getElementById('iyzico-widget');if(existing)existing.remove();const widget=document.createElement('div');widget.id='iyzico-widget';widget.style.cssText='border:1px solid #e5e7eb;border-radius:8px;padding:16px;margin:16px 0;background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.1)';if(data.found&&data.iyzico_payment_id){widget.innerHTML='<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px"><h2 style="margin:0;font-size:18px;font-weight:600">Ä°yzico Payment</h2><span style="background:#10b981;color:white;padding:4px 8px;border-radius:4px;font-size:12px">Ä°yzico</span></div><div style="display:flex;justify-content:space-between;align-items:center"><span style="color:#6b7280;font-size:14px">Payment ID:</span><span style="font-family:monospace;font-size:14px;font-weight:500;background:#f3f4f6;padding:4px 8px;border-radius:4px;border:1px solid #d1d5db">"'+data.iyzico_payment_id+'"</span></div>';}else{widget.innerHTML='<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px"><h2 style="margin:0;font-size:18px;font-weight:600">Ä°yzico Payment</h2><span style="background:#f59e0b;color:white;padding:4px 8px;border-radius:4px;font-size:12px">Not Ä°yzico</span></div><p style="margin:0;color:#6b7280;font-size:14px">Bu sipariÅŸ Ä°yzico ile Ã¶denmemiÅŸ.</p>';}document.body.appendChild(widget);}).catch(err=>{alert('Ä°yzico API hatasÄ±: '+err.message);});})();

2. Browser'da yeni bookmark oluÅŸturun ve bu kodu URL kÄ±smÄ±na yapÄ±ÅŸtÄ±rÄ±n
3. Order detail sayfasÄ±nda bookmark'a tÄ±klayÄ±n
4. Ä°yzico widget otomatik olarak gÃ¶rÃ¼necek!
`);